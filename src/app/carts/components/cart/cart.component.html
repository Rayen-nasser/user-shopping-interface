<div class="cartBox">
  <h1 class="text-primary">Shopping Cart</h1>

  <ng-container *ngIf="cardVide">
    <div class="headCart">
      <p class="lead">
        You have <label class="text-primary">{{ cartProducts.length }}</label>
        {{ cartProducts.length === 1 ? "item" : "items" }} in your cart
      </p>
      <span
        class="text-primary card-header p-2 d-none d-sm-table"
        (click)="deleteAllProducts()"
      >
        Clear Shopping Cart
      </span>
    </div>
    <div class="table-responsive">
      <!-- Small Screen View -->
      <table class="table table-striped d-block d-sm-none">
        <tbody>
          <tr *ngFor="let item of cartProducts; let index = index">
            <td>
              <img src="{{ item.item.imageUrl }}" alt="" />
              <div class="quantity">
                <button
                  class="btn btn-primary"
                  (click)="increaseQuantity(index)"
                >
                  +
                </button>
                <input
                  class="form-control"
                  (change)="detectChange($event)"
                  type="text"
                  [(ngModel)]="item.quantity"
                  min="1"
                  [max]="item.item.quantity"
                />
                <button
                  class="btn btn-primary"
                  (click)="decreaseQuantity(index)"
                >
                  -
                </button>
              </div>
            </td>
            <td>
              <div class="mb-5">
                {{ item.item.name }}
              </div>
              <div class="price text-muted">
                ${{ item.item.price }}
                <i
                  class="bi bi-x-lg btn text-danger"
                  (click)="deleteProduct(index)"
                ></i>
              </div>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <th class="text-center">Total: {{ totalPrice.toFixed(2) }} $</th>
          </tr>
          <tr>
            <td class="text-end" colspan="2">
              <button class="btn btn-success w-100" (click)="order()">
                Order Now
              </button>
            </td>
          </tr>
        </tfoot>
      </table>

      <!-- Large Screen View -->
      <table class="table table-striped d-none d-sm-table">
        <thead>
          <tr class="text-center">
            <th></th>
            <th>Name</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Total</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of cartProducts; let index = index">
            <td><img src="{{ item.item.imageUrl }}" alt="" /></td>
            <td>{{ item.item.name }}</td>
            <td>{{ item.item.price }} $</td>
            <td>
              <div class="quantity">
                <button
                  class="btn btn-primary"
                  (click)="increaseQuantity(index)"
                >
                  +
                </button>
                <input
                  class="form-control"
                  (change)="detectChange($event)"
                  type="number"
                  [(ngModel)]="item.quantity"
                  min="1"
                  [max]="item.item.quantity"
                />
                <button
                  class="btn btn-primary"
                  (click)="decreaseQuantity(index)"
                >
                  -
                </button>
              </div>
            </td>
            <td>{{ (item.item.price * item.quantity).toFixed(2) }} L.E</td>
            <td>
              <button class="btn btn-danger" (click)="deleteProduct(index)">
                Delete
              </button>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <th colspan="4"></th>
            <th>Total: {{ totalPrice.toFixed(2) }} $</th>
            <th>
              <button class="btn btn-success" (click)="order()">
                Order Now
              </button>
            </th>
          </tr>
        </tfoot>
      </table>
    </div>
  </ng-container>

  <!-- Template for empty cart -->
  <ng-template *ngIf="!cardVide">
    <p class="lead">Your shopping cart is empty.</p>
    <div class="giphy-container">
      <div
        style="width: 100%; height: 0; padding-bottom: 100%; position: relative"
      >
        <iframe
          src="https://giphy.com/embed/26hkhPJ5hmdD87HYA"
          width="100%"
          height="100%"
          style="position: absolute"
          frameborder="0"
          class="giphy-embed"
          allowfullscreen
        ></iframe>
      </div>
      <p>
        <a
          href="https://giphy.com/gifs/kitchen-looney-tunes-empty-26hkhPJ5hmdD87HYA"
          >via GIPHY</a
        >
      </p>
    </div>
  </ng-template>
</div>
